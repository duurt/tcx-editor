using NUnit.Framework;
using Shouldly;
using System;
using System.IO;

namespace TcxEditor.Parser.Tests
{
    [TestFixture]
    public class XmlParserTests
    {
        private readonly Stream _defaultInput = new MemoryStream(Convert.FromBase64String("PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPFRyYWluaW5nQ2VudGVyRGF0YWJhc2UgeG1sbnM9Imh0dHA6Ly93d3cuZ2FybWluLmNvbS94bWxzY2hlbWFzL1RyYWluaW5nQ2VudGVyRGF0YWJhc2UvdjIiIHhtbG5zOnhzaT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS9YTUxTY2hlbWEtaW5zdGFuY2UiIHhzaTpzY2hlbWFMb2NhdGlvbj0iaHR0cDovL3d3dy5nYXJtaW4uY29tL3htbHNjaGVtYXMvVHJhaW5pbmdDZW50ZXJEYXRhYmFzZS92MiBodHRwOi8vd3d3Lmdhcm1pbi5jb20veG1sc2NoZW1hcy9UcmFpbmluZ0NlbnRlckRhdGFiYXNldjIueHNkIj4KICA8Rm9sZGVycz4KICAgIDxDb3Vyc2VzPgogICAgICA8Q291cnNlRm9sZGVyIE5hbWU9IkNvdXJzZXMiPgogICAgICAgIDxDb3Vyc2VOYW1lUmVmPgogICAgICAgICAgPElkPnRyeW91dDwvSWQ+CiAgICAgICAgPC9Db3Vyc2VOYW1lUmVmPgogICAgICA8L0NvdXJzZUZvbGRlcj4KICAgIDwvQ291cnNlcz4KICA8L0ZvbGRlcnM+CiAgPENvdXJzZXM+CiAgICA8Q291cnNlPgogICAgICA8TmFtZT50cnlvdXQ8L05hbWU+CiAgICAgIDxMYXA+CiAgICAgICAgPFRvdGFsVGltZVNlY29uZHM+MTA8L1RvdGFsVGltZVNlY29uZHM+CiAgICAgICAgPERpc3RhbmNlTWV0ZXJzPjU4LjQ0NjwvRGlzdGFuY2VNZXRlcnM+CiAgICAgICAgPEJlZ2luUG9zaXRpb24+CiAgICAgICAgICA8TGF0aXR1ZGVEZWdyZWVzPjUzLjE3NzwvTGF0aXR1ZGVEZWdyZWVzPgogICAgICAgICAgPExvbmdpdHVkZURlZ3JlZXM+Ni42MTk2NzwvTG9uZ2l0dWRlRGVncmVlcz4KICAgICAgICA8L0JlZ2luUG9zaXRpb24+CiAgICAgICAgPEVuZFBvc2l0aW9uPgogICAgICAgICAgPExhdGl0dWRlRGVncmVlcz41My4xNzY4NjwvTGF0aXR1ZGVEZWdyZWVzPgogICAgICAgICAgPExvbmdpdHVkZURlZ3JlZXM+Ni42MjAzNjwvTG9uZ2l0dWRlRGVncmVlcz4KICAgICAgICA8L0VuZFBvc2l0aW9uPgogICAgICAgIDxJbnRlbnNpdHk+QWN0aXZlPC9JbnRlbnNpdHk+CiAgICAgIDwvTGFwPgogICAgICA8VHJhY2s+CiAgICAgICAgPFRyYWNrcG9pbnQ+CiAgICAgICAgICA8VGltZT4yMDE5LTA3LTMwVDIxOjEyOjA2WjwvVGltZT4KICAgICAgICAgIDxQb3NpdGlvbj4KICAgICAgICAgICAgPExhdGl0dWRlRGVncmVlcz41My4xNzc8L0xhdGl0dWRlRGVncmVlcz4KICAgICAgICAgICAgPExvbmdpdHVkZURlZ3JlZXM+Ni42MTk2NzwvTG9uZ2l0dWRlRGVncmVlcz4KICAgICAgICAgIDwvUG9zaXRpb24+CiAgICAgICAgICA8QWx0aXR1ZGVNZXRlcnM+MC42PC9BbHRpdHVkZU1ldGVycz4KICAgICAgICAgIDxEaXN0YW5jZU1ldGVycz4wPC9EaXN0YW5jZU1ldGVycz4KICAgICAgICA8L1RyYWNrcG9pbnQ+CiAgICAgICAgPFRyYWNrcG9pbnQ+CiAgICAgICAgICA8VGltZT4yMDE5LTA3LTMwVDIxOjEyOjE2WjwvVGltZT4KICAgICAgICAgIDxQb3NpdGlvbj4KICAgICAgICAgICAgPExhdGl0dWRlRGVncmVlcz41My4xNzY5NzwvTGF0aXR1ZGVEZWdyZWVzPgogICAgICAgICAgICA8TG9uZ2l0dWRlRGVncmVlcz42LjYxOTY3PC9Mb25naXR1ZGVEZWdyZWVzPgogICAgICAgICAgPC9Qb3NpdGlvbj4KICAgICAgICAgIDxBbHRpdHVkZU1ldGVycz4wLjY8L0FsdGl0dWRlTWV0ZXJzPgogICAgICAgICAgPERpc3RhbmNlTWV0ZXJzPjMuMzQ8L0Rpc3RhbmNlTWV0ZXJzPgogICAgICAgIDwvVHJhY2twb2ludD4KICAgICAgICA8VHJhY2twb2ludD4KICAgICAgICAgIDxUaW1lPjIwMTktMDctMzBUMjE6MTI6MjZaPC9UaW1lPgogICAgICAgICAgPFBvc2l0aW9uPgogICAgICAgICAgICA8TGF0aXR1ZGVEZWdyZWVzPjUzLjE3Njk0PC9MYXRpdHVkZURlZ3JlZXM+CiAgICAgICAgICAgIDxMb25naXR1ZGVEZWdyZWVzPjYuNjE5Njk8L0xvbmdpdHVkZURlZ3JlZXM+CiAgICAgICAgICA8L1Bvc2l0aW9uPgogICAgICAgICAgPEFsdGl0dWRlTWV0ZXJzPjAuNjwvQWx0aXR1ZGVNZXRlcnM+CiAgICAgICAgICA8RGlzdGFuY2VNZXRlcnM+Ni45MzY8L0Rpc3RhbmNlTWV0ZXJzPgogICAgICAgIDwvVHJhY2twb2ludD4KICAgICAgICA8VHJhY2twb2ludD4KICAgICAgICAgIDxUaW1lPjIwMTktMDctMzBUMjE6MTI6MzZaPC9UaW1lPgogICAgICAgICAgPFBvc2l0aW9uPgogICAgICAgICAgICA8TGF0aXR1ZGVEZWdyZWVzPjUzLjE3NjkyPC9MYXRpdHVkZURlZ3JlZXM+CiAgICAgICAgICAgIDxMb25naXR1ZGVEZWdyZWVzPjYuNjE5NzI8L0xvbmdpdHVkZURlZ3JlZXM+CiAgICAgICAgICA8L1Bvc2l0aW9uPgogICAgICAgICAgPEFsdGl0dWRlTWV0ZXJzPjAuNzwvQWx0aXR1ZGVNZXRlcnM+CiAgICAgICAgICA8RGlzdGFuY2VNZXRlcnM+OS45MzwvRGlzdGFuY2VNZXRlcnM+CiAgICAgICAgPC9UcmFja3BvaW50PgogICAgICAgIDxUcmFja3BvaW50PgogICAgICAgICAgPFRpbWU+MjAxOS0wNy0zMFQyMToxMjo0Nlo8L1RpbWU+CiAgICAgICAgICA8UG9zaXRpb24+CiAgICAgICAgICAgIDxMYXRpdHVkZURlZ3JlZXM+NTMuMTc2OTE8L0xhdGl0dWRlRGVncmVlcz4KICAgICAgICAgICAgPExvbmdpdHVkZURlZ3JlZXM+Ni42MTk3NTwvTG9uZ2l0dWRlRGVncmVlcz4KICAgICAgICAgIDwvUG9zaXRpb24+CiAgICAgICAgICA8QWx0aXR1ZGVNZXRlcnM+MC43PC9BbHRpdHVkZU1ldGVycz4KICAgICAgICAgIDxEaXN0YW5jZU1ldGVycz4xMi4yMjwvRGlzdGFuY2VNZXRlcnM+CiAgICAgICAgPC9UcmFja3BvaW50PgogICAgICAgIDxUcmFja3BvaW50PgogICAgICAgICAgPFRpbWU+MjAxOS0wNy0zMFQyMToxMjo1Nlo8L1RpbWU+CiAgICAgICAgICA8UG9zaXRpb24+CiAgICAgICAgICAgIDxMYXRpdHVkZURlZ3JlZXM+NTMuMTc2ODk8L0xhdGl0dWRlRGVncmVlcz4KICAgICAgICAgICAgPExvbmdpdHVkZURlZ3JlZXM+Ni42MTk4MTwvTG9uZ2l0dWRlRGVncmVlcz4KICAgICAgICAgIDwvUG9zaXRpb24+CiAgICAgICAgICA8QWx0aXR1ZGVNZXRlcnM+MC44PC9BbHRpdHVkZU1ldGVycz4KICAgICAgICAgIDxEaXN0YW5jZU1ldGVycz4xNi44MDE8L0Rpc3RhbmNlTWV0ZXJzPgogICAgICAgIDwvVHJhY2twb2ludD4KICAgICAgICA8VHJhY2twb2ludD4KICAgICAgICAgIDxUaW1lPjIwMTktMDctMzBUMjE6MTM6MDZaPC9UaW1lPgogICAgICAgICAgPFBvc2l0aW9uPgogICAgICAgICAgICA8TGF0aXR1ZGVEZWdyZWVzPjUzLjE3Njg2PC9MYXRpdHVkZURlZ3JlZXM+CiAgICAgICAgICAgIDxMb25naXR1ZGVEZWdyZWVzPjYuNjE5ODk8L0xvbmdpdHVkZURlZ3JlZXM+CiAgICAgICAgICA8L1Bvc2l0aW9uPgogICAgICAgICAgPEFsdGl0dWRlTWV0ZXJzPjAuOTwvQWx0aXR1ZGVNZXRlcnM+CiAgICAgICAgICA8RGlzdGFuY2VNZXRlcnM+MjMuMDk3PC9EaXN0YW5jZU1ldGVycz4KICAgICAgICA8L1RyYWNrcG9pbnQ+CiAgICAgICAgPFRyYWNrcG9pbnQ+CiAgICAgICAgICA8VGltZT4yMDE5LTA3LTMwVDIxOjEzOjE2WjwvVGltZT4KICAgICAgICAgIDxQb3NpdGlvbj4KICAgICAgICAgICAgPExhdGl0dWRlRGVncmVlcz41My4xNzY4MzwvTGF0aXR1ZGVEZWdyZWVzPgogICAgICAgICAgICA8TG9uZ2l0dWRlRGVncmVlcz42LjYxOTk3PC9Mb25naXR1ZGVEZWdyZWVzPgogICAgICAgICAgPC9Qb3NpdGlvbj4KICAgICAgICAgIDxBbHRpdHVkZU1ldGVycz4xPC9BbHRpdHVkZU1ldGVycz4KICAgICAgICAgIDxEaXN0YW5jZU1ldGVycz4yOS4zOTM8L0Rpc3RhbmNlTWV0ZXJzPgogICAgICAgIDwvVHJhY2twb2ludD4KICAgICAgICA8VHJhY2twb2ludD4KICAgICAgICAgIDxUaW1lPjIwMTktMDctMzBUMjE6MTM6MjZaPC9UaW1lPgogICAgICAgICAgPFBvc2l0aW9uPgogICAgICAgICAgICA8TGF0aXR1ZGVEZWdyZWVzPjUzLjE3Njc5PC9MYXRpdHVkZURlZ3JlZXM+CiAgICAgICAgICAgIDxMb25naXR1ZGVEZWdyZWVzPjYuNjIwMDU8L0xvbmdpdHVkZURlZ3JlZXM+CiAgICAgICAgICA8L1Bvc2l0aW9uPgogICAgICAgICAgPEFsdGl0dWRlTWV0ZXJzPjE8L0FsdGl0dWRlTWV0ZXJzPgogICAgICAgICAgPERpc3RhbmNlTWV0ZXJzPjM2LjM0NDwvRGlzdGFuY2VNZXRlcnM+CiAgICAgICAgPC9UcmFja3BvaW50PgogICAgICAgIDxUcmFja3BvaW50PgogICAgICAgICAgPFRpbWU+MjAxOS0wNy0zMFQyMToxMzo0Nlo8L1RpbWU+CiAgICAgICAgICA8UG9zaXRpb24+CiAgICAgICAgICAgIDxMYXRpdHVkZURlZ3JlZXM+NTMuMTc2ODY8L0xhdGl0dWRlRGVncmVlcz4KICAgICAgICAgICAgPExvbmdpdHVkZURlZ3JlZXM+Ni42MjAzNjwvTG9uZ2l0dWRlRGVncmVlcz4KICAgICAgICAgIDwvUG9zaXRpb24+CiAgICAgICAgICA8QWx0aXR1ZGVNZXRlcnM+MS4xPC9BbHRpdHVkZU1ldGVycz4KICAgICAgICAgIDxEaXN0YW5jZU1ldGVycz41OC40NDY8L0Rpc3RhbmNlTWV0ZXJzPgogICAgICAgIDwvVHJhY2twb2ludD4KICAgICAgPC9UcmFjaz4KICAgICAgPENvdXJzZVBvaW50PgogICAgICAgIDxOYW1lPlN0YXJ0IG9mIHI8L05hbWU+CiAgICAgICAgPFRpbWU+MjAxOS0wNy0zMFQyMToxMjowNlo8L1RpbWU+CiAgICAgICAgPFBvc2l0aW9uPgogICAgICAgICAgPExhdGl0dWRlRGVncmVlcz41My4xNzc8L0xhdGl0dWRlRGVncmVlcz4KICAgICAgICAgIDxMb25naXR1ZGVEZWdyZWVzPjYuNjE5Njc8L0xvbmdpdHVkZURlZ3JlZXM+CiAgICAgICAgPC9Qb3NpdGlvbj4KICAgICAgICA8UG9pbnRUeXBlPkdlbmVyaWM8L1BvaW50VHlwZT4KICAgICAgICA8Tm90ZXM+U3RhcnQgb2Ygcm91dGU8L05vdGVzPgogICAgICA8L0NvdXJzZVBvaW50PgogICAgICA8Q291cnNlUG9pbnQ+CiAgICAgICAgPE5hbWU+U2xhIGxpbmtzYTwvTmFtZT4KICAgICAgICA8VGltZT4yMDE5LTA3LTMwVDIxOjEzOjI2WjwvVGltZT4KICAgICAgICA8UG9zaXRpb24+CiAgICAgICAgICA8TGF0aXR1ZGVEZWdyZWVzPjUzLjE3Njc5PC9MYXRpdHVkZURlZ3JlZXM+CiAgICAgICAgICA8TG9uZ2l0dWRlRGVncmVlcz42LjYyMDA1PC9Mb25naXR1ZGVEZWdyZWVzPgogICAgICAgIDwvUG9zaXRpb24+CiAgICAgICAgPFBvaW50VHlwZT5MZWZ0PC9Qb2ludFR5cGU+CiAgICAgICAgPE5vdGVzPlNsYSBsaW5rc2FmIG5hYXIgZGUgV2VkZXJpa3dlZzwvTm90ZXM+CiAgICAgIDwvQ291cnNlUG9pbnQ+CiAgICAgIDxDb3Vyc2VQb2ludD4KICAgICAgICA8TmFtZT5FbmQgb2Ygcm91PC9OYW1lPgogICAgICAgIDxUaW1lPjIwMTktMDctMzBUMjE6MTM6NDZaPC9UaW1lPgogICAgICAgIDxQb3NpdGlvbj4KICAgICAgICAgIDxMYXRpdHVkZURlZ3JlZXM+NTMuMTc2ODY8L0xhdGl0dWRlRGVncmVlcz4KICAgICAgICAgIDxMb25naXR1ZGVEZWdyZWVzPjYuNjIwMzY8L0xvbmdpdHVkZURlZ3JlZXM+CiAgICAgICAgPC9Qb3NpdGlvbj4KICAgICAgICA8UG9pbnRUeXBlPkdlbmVyaWM8L1BvaW50VHlwZT4KICAgICAgICA8Tm90ZXM+RW5kIG9mIHJvdXRlPC9Ob3Rlcz4KICAgICAgPC9Db3Vyc2VQb2ludD4KICAgIDwvQ291cnNlPgogIDwvQ291cnNlcz4KPC9UcmFpbmluZ0NlbnRlckRhdGFiYXNlPgo="));

        [Test]
        public void Parse_can_parse_simple_example()
        {
            var sut = new XmlParser();
            var result = sut.Parse(_defaultInput);

            result.ShouldNotBeNull();
            result.Courses[0].Track.Length.ShouldBe(10);
            result.Courses[0].CoursePoint.Length.ShouldBe(3);
        }
    }
}
